import{_ as e}from"./index.6b2042dd.js";import{_ as a}from"./index.5b797a78.js";import{d as l,t,x as s,k as i,l as u,o,c as r,s as m,w as n,C as d,y as c,G as p,H as f,E as v}from"./index.10862972.js";import{E as b,a as g}from"./el-col.7d31742a.js";import{E as _,a as h}from"./el-form-item.2bce87b5.js";import{E as j}from"./el-input.2ed03bb1.js";import{_ as x}from"./index.0d847f85.js";import{E as y}from"./el-button.b516a904.js";/* empty css                */import{a as k}from"./index.8b11fa54.js";import{b as E}from"./route-block.b5bad31b.js";import"./event.4982e83d.js";import"./isEqual.5524155d.js";import"./index.a1792b3c.js";const V=d(" 返回 "),C=d("取消"),w=d("提交"),q=l({name:"PersonalEditEmail"}),z=Object.assign(q,{setup(l){t();const E=s();i();const q=u({email:"",captcha:""}),z=u({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",trigger:"blur",message:"请输入正确的邮箱格式"}],captcha:[{required:!0,trigger:"blur",message:"请输入验证码"},{min:4,max:4,trigger:"blur",message:"验证码长度必须为4位"}]}),I=u(!1),P="{{time}}s后重新获取";let U=u(25);const F=u("发送验证码"),G=u(null);function H(){U.value=25,G.value.validateField("email",(e=>{if(e){new Promise(((e,a)=>{p.post("/api/sendmail",{mail:q.value.email}).then((()=>{f({type:"success",message:"验证码已经发至邮箱"})})).catch((e=>{a(e)}))})),F.value=P.replace("{{time}}",U.value);let e=setInterval((()=>{U.value--,U.value<=0?(F.value="发送验证码",clearInterval(e),I.value=!1):F.value=P.replace("{{time}}",U.value)}),1e3)}}))}function O(){G.value.validate((e=>{e&&p.post("api/checkmail",{mail:q.value.email,checknum:q.value.captcha}).then((()=>{f({type:"success",message:"邮箱绑定成功"}),R()})).catch((()=>{}))}))}function R(){E.push({name:"personalSetting"})}return(l,t)=>{const s=k,i=v,u=y,p=x,f=j,E=_,P=h,U=b,S=g,A=a,B=e;return o(),r("div",null,[m(p,{title:"修改邮箱",content:"绑定邮箱可以提高帐号安全性噢~"},{default:n((()=>[m(u,{size:"default",round:"",onClick:R},{icon:n((()=>[m(i,null,{default:n((()=>[m(s,{name:"ep:arrow-left"})])),_:1})])),default:n((()=>[V])),_:1})])),_:1}),m(A,null,{default:n((()=>[m(S,null,{default:n((()=>[m(U,{md:24,lg:12},{default:n((()=>[m(P,{ref_key:"formRef",ref:G,model:q.value,rules:z.value,"label-width":"120px"},{default:n((()=>[m(E,{label:"邮箱",prop:"email"},{default:n((()=>[m(f,{modelValue:q.value.email,"onUpdate:modelValue":t[0]||(t[0]=e=>q.value.email=e),type:"text",placeholder:"请输入邮箱号"},null,8,["modelValue"])])),_:1}),m(E,{label:"验证码",prop:"captcha"},{default:n((()=>[m(f,{ref:"captcha",modelValue:q.value.captcha,"onUpdate:modelValue":t[1]||(t[1]=e=>q.value.captcha=e),type:"text",autocomplete:"on",placeholder:"请输入验证码"},{append:n((()=>[m(u,{disabled:I.value,onClick:H},{default:n((()=>[d(c(F.value),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1}),m(B,null,{default:n((()=>[m(u,{size:"large",onClick:R},{default:n((()=>[C])),_:1}),m(u,{type:"primary",size:"large",onClick:O},{default:n((()=>[w])),_:1})])),_:1})])}}});"function"==typeof E&&E(z);export{z as default};

import{_ as e}from"./index.e9650b49.js";import{_ as a}from"./index.c3bae937.js";import{d as l,y as t,z as s,k as i,l as u,o,c as r,s as m,w as c,F as n,A as d,G as p,H as f,E as v}from"./index.03c48972.js";import{E as b,a as g}from"./el-col.98a353ff.js";import{E as _,a as h}from"./el-form-item.4228ab23.js";import{E as j}from"./el-input.c98f0ce0.js";import{_ as x}from"./index.f4cb397b.js";import{E as y}from"./el-button.0f152581.js";/* empty css                */import{a as k}from"./index.5b3d3b8c.js";import{b as E}from"./route-block.7fdbc26a.js";import"./event.69d56c48.js";import"./isEqual.47868e98.js";import"./index.285dd25f.js";const V=n(" 返回 "),w=n("取消"),z=n("提交"),C=l({name:"PersonalEditEmail"}),q=Object.assign(C,{setup(l){t();const E=s();i();const C=u({email:"",captcha:""}),q=u({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",trigger:"blur",message:"请输入正确的邮箱格式"}],captcha:[{required:!0,trigger:"blur",message:"请输入验证码"},{min:4,max:4,trigger:"blur",message:"验证码长度必须为4位"}]}),F=u(!1),I="{{time}}s后重新获取";let P=u(25);const U=u("发送验证码"),A=u(null);function G(){P.value=25,A.value.validateField("email",(e=>{if(e){new Promise(((e,a)=>{p.post("/api/sendmail",{mail:C.value.email}).then((()=>{f({type:"success",message:"验证码已经发至邮箱"})})).catch((e=>{a(e)}))})),U.value=I.replace("{{time}}",P.value);let e=setInterval((()=>{P.value--,P.value<=0?(U.value="发送验证码",clearInterval(e),F.value=!1):U.value=I.replace("{{time}}",P.value)}),1e3)}}))}function H(){A.value.validate((e=>{e&&p.post("api/checkmail",{mail:C.value.email,checknum:C.value.captcha}).then((()=>{f({type:"success",message:"邮箱绑定成功"}),O()})).catch((()=>{}))}))}function O(){E.push({name:"personalSetting"})}return(l,t)=>{const s=k,i=v,u=y,p=x,f=j,E=_,I=h,P=b,R=g,S=a,B=e;return o(),r("div",null,[m(p,{title:"修改邮箱",content:"绑定邮箱可以提高帐号安全性噢~"},{default:c((()=>[m(u,{size:"default",round:"",onClick:O},{icon:c((()=>[m(i,null,{default:c((()=>[m(s,{name:"ep:arrow-left"})])),_:1})])),default:c((()=>[V])),_:1})])),_:1}),m(S,null,{default:c((()=>[m(R,null,{default:c((()=>[m(P,{md:24,lg:12},{default:c((()=>[m(I,{ref_key:"formRef",ref:A,model:C.value,rules:q.value,"label-width":"120px"},{default:c((()=>[m(E,{label:"邮箱",prop:"email"},{default:c((()=>[m(f,{modelValue:C.value.email,"onUpdate:modelValue":t[0]||(t[0]=e=>C.value.email=e),type:"text",placeholder:"请输入邮箱号"},null,8,["modelValue"])])),_:1}),m(E,{label:"验证码",prop:"captcha"},{default:c((()=>[m(f,{ref:"captcha",modelValue:C.value.captcha,"onUpdate:modelValue":t[1]||(t[1]=e=>C.value.captcha=e),type:"text",autocomplete:"on",placeholder:"请输入验证码"},{append:c((()=>[m(u,{disabled:F.value,onClick:G},{default:c((()=>[n(d(U.value),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1}),m(B,null,{default:c((()=>[m(u,{size:"large",onClick:O},{default:c((()=>[w])),_:1}),m(u,{type:"primary",size:"large",onClick:H},{default:c((()=>[z])),_:1})])),_:1})])}}});"function"==typeof E&&E(q);export{q as default};
